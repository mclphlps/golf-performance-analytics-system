ts,stage_name,notes,rows_before,rows_after,row_delta,row_pct_change,cols_before,cols_after,new_cols,dropped_cols
2025-12-04 11:57:03,2.1_raw_import,Initial GolfShot CSV ingest + deterministic row_id assignment.,,4540,,,,24,['row_id'],[]
2025-12-04 11:57:03,2.2_standardize_schema,"Renamed vendor columns to internal schema, parsed timestamps, normalized GIR, and enforced dtypes.",4540.0,4540,0.0,0.0,24.0,24,"['player_name', 'round_dt', 'facility', 'course', 'round_score', 'round_fairway_hits', 'round_putts', 'round_gir', 'hole_number', 'hole_par', 'hole_fairway_hit_type', 'hole_fairway_hits', 'hole_putts', 'hole_score', 'hole_gir', 'shot_club', 'shot_direction', 'shot_start_lat', 'shot_start_lon', 'shot_end_lat', 'shot_end_lon', 'yardage', 'yardage_to_pin']","['Name', 'Round DateTime (UTC)', 'Facility Name', 'Course Name', 'Round Score', 'Round Fairway Hits', 'Round Putts', 'Round GIR', 'Hole Number', 'Hole Par', 'Hole Fairway Hit Type', 'Hole Fairway Hits', 'Hole Putts', 'Hole Score', 'Hole GIR', 'Shot Club', 'Shot Direction', 'Shot Start Latitude', 'Shot Start Longitude', 'Shot End Latitude', 'Shot End Longitude', 'Yardage', 'Yardage To Pin']"
2025-12-04 11:57:03,2.4_core_field_validation,"Executed logical sanity checks (hole_number range, hole_score>0, timestamp presence, plausible round_score) without mutating data.",4540.0,4540,0.0,0.0,24.0,24,[],[]
2025-12-04 11:57:04,2.5_vendor_yardage_validation,Added GPS-based yardage diagnostics and suspect flag for GPS-complete shot rows.,4540.0,4540,0.0,0.0,24.0,29,"['yardage_calc', 'yardage_error', 'yardage_error_abs', 'yardage_error_pct', 'yardage_suspect']",[]
2025-12-04 11:57:09,3.1.1_filter_invalid_holes,Filtered to scored holes only (hole_score > 0). Retained 4265 of 4540 rows (93.94%).,4540.0,4265,-275.0,-0.0605726872246696,29.0,29,[],[]
2025-12-04 11:57:09,3.1.2_build_round_hole_counts_helper,Created round-level helper (holes_per_round) from golf_valid to support completeness checks.,,213,,,,5,['holes_scored_in_round'],[]
2025-12-04 11:57:09,3.1.3_attach_round_hole_counts,Joined per-round hole counts and flagged 4 partial round(s).,4265.0,4265,0.0,0.0,29.0,31,"['holes_scored_in_round', 'is_partial_round']",[]
2025-12-04 11:57:09,3.1.4_keep_only_complete_rounds,"Filtered working dataset to retain only rounds with holes_scored_in_round in {9, 18}. Retained 4240 of 4265 rows (99.41%).",4265.0,4240,-25.0,-0.005861664712778429,31.0,31,[],[]
2025-12-04 11:57:09,3.1.5_assign_round_no_player,Added sequential round index per player (dense rank on round_dt).,4240.0,4240,0.0,0.0,31.0,32,['round_no_player'],[]
2025-12-04 11:57:10,3.1.6_assign_round_no_player_course,Added per-player × facility × course visit sequencing (round_no_player_course).,4240.0,4240,0.0,0.0,32.0,33,['round_no_player_course'],[]
2025-12-04 11:57:10,3.1.7_create_round_id,Attached surrogate round_id and audit-friendly round_key to hole-level data.,4240.0,4240,0.0,0.0,33.0,35,"['round_id', 'round_key']",[]
2025-12-04 11:57:10,3.1.8.1_derive_time_features,"Added time-derived context fields (date, time, hour, dow, is_weekend, part_of_day).",4240.0,4240,0.0,0.0,35.0,41,"['date', 'time', 'hour', 'dow', 'is_weekend', 'part_of_day']",[]
2025-12-04 11:57:10,3.1.8.2_validate_round_time_quality,Added round_time_valid flag and normalized part_of_day='Unknown' for implausible tee times.,4240.0,4240,0.0,0.0,41.0,42,['round_time_valid'],[]
2025-12-04 11:57:10,3.1.8.3_derive_seasonal_annual_context,Added year/month/season/year_month and round_year_index for longitudinal context.,4240.0,4240,0.0,0.0,42.0,48,"['year', 'month', 'month_name', 'year_month', 'season', 'round_year_index']",[]
2025-12-04 11:57:10,3.1.9_rename_columns_for_analysis,"Standardized mixed-grain columns to round_*, hole_*, shot_* naming and normalized hole_gir to boolean.",4240.0,4240,0.0,0.0,48.0,48,"['round_fairway_strokes', 'shot_fairway_hit_type', 'hole_fairway_strokes', 'round_holes_scored', 'round_is_partial']","['round_fairway_hits', 'hole_fairway_hit_type', 'hole_fairway_hits', 'holes_scored_in_round', 'is_partial_round']"
2025-12-04 11:57:10,3.1.10_round_level_closeout,"Phase 3.1 complete: round-level filters, sequencing, time features, and naming conventions applied.",,4240,,,,48,[],[]
2025-12-04 11:57:10,3.2.1_hole_level_context_features,"Added hole_par_bucket, hole_strokes_over_par, and hole_score_name derived from hole_par and hole_score.",4240.0,4240,0.0,0.0,48.0,51,"['hole_par_bucket', 'hole_strokes_over_par', 'hole_score_name']",[]
2025-12-04 11:57:11,3.2.2_hole_level_putting_flags,Added hole-level putting flags and over-expected metric.,4240.0,4240,0.0,0.0,51.0,55,"['hole_putts_over_expected', 'hole_putts_3plus', 'hole_gir_putts_3plus', 'hole_notgir_putts_3plus']",[]
2025-12-04 11:57:11,3.2.3_hole_outcome_quality_signals,"Added scramble opportunity/success, wasted GIR, non-GIR chip-ins, and situation tags.",4240.0,4240,0.0,0.0,55.0,61,"['hole_scramble_opportunity', 'hole_scramble_success', 'hole_gir_wasted', 'hole_notgir_chip_in', 'hole_is_scoring_chance', 'hole_is_recovery']",[]
2025-12-04 11:57:11,3.2.4_hole_level_closeout,"Hole-level features finalized; validation, profile, and hole centroids captured.",4240.0,4240,0.0,0.0,61.0,64,"['hole_lat', 'hole_lon', 'hole_gps_points']",[]
2025-12-04 11:57:11,3.3.1_build_player_club_profile,Built per-player × per-club planning profile with p30/p60/p85 distances and app-recorded directional mix from shot_fairway_hit_type. 15/15 groups have ≥5 shots.,,15,,,,23,[],[]
2025-12-04 11:57:17,3.3.2_player_club_hole_dispersion,"Per hole, used first→last shot as line-of-play; computed sided dispersion at p=1.0; kept calc_* anchors for mapping/debug.",,267,,,,16,[],[]
2025-12-04 11:57:18,3.3.3_player_club_dispersion_rollup,"Rolled up hole-level dispersion to player+club using WEIGHT_BY_SHOTS=False, strategy=nonzero_p75. Holes with more shots influence the club-level dispersion more.",,14,,,,8,[],[]
2025-12-04 11:57:18,3.3.4_attach_dispersion_to_player_club_profile,"Enriched player_club_profile with dispersion metrics from 3.3.3 (plan_dispersion, dispersion_hole_count, dispersion_shot_count) in an idempotent way.",15.0,15,0.0,0.0,23.0,26,"['plan_dispersion', 'dispersion_hole_count', 'dispersion_shot_count']",[]
2025-12-04 11:57:18,3.3.5_enrich_club_profile_with_cone_fields,"Calibrated per-player dispersion cone from driver (1W) using plan_dispersion and plan_distance_long, then projected expected dispersion to all clubs at short/hit/long planning distances.",15.0,15,0.0,0.0,26.0,32,"['disp_half_angle_rad', 'disp_half_angle_deg', 'disp_tan_half_angle', 'plan_dispersion_short', 'plan_dispersion_hit', 'plan_dispersion_long']",[]
2025-12-04 11:57:18,3.3.6_club_level_closeout,"Closed out 3.3 club-level features; validated base, hole-level, rollup, and cone-enriched club profile; captured QA metrics.",15.0,15,0.0,0.0,32.0,35,"['join_key', 'join_key_cone', 'join_key_aim']",[]
2025-12-04 11:57:18,3.4.1_build_or_refresh_facilities,Built facilities from golf_valid and merged user-provided hint columns from cache if available.,,30,,,,16,"['facility', 'course', 'first_seen_round_dt', 'last_seen_round_dt', 'rounds_observed', 'hint_city', 'hint_state_abbr', 'facility_course_key', 'shot_centroid_lat', 'shot_centroid_lon', 'shots_used_for_centroids', 'geo_lat', 'geo_lon', 'geo_source', 'geo_query_used', 'facility_tz']",[]
2025-12-04 11:57:18,3.4.2_derive_shot_based_centroids,Added/updated shot_centroid_* columns from observed shot GPS; re-runnable without duplicate columns.,30.0,30,0.0,0.0,16.0,16,"['shot_centroid_lat', 'shot_centroid_lon', 'shots_used_for_centroids']",[]
2025-12-04 11:57:18,3.4.3_geocode_remaining_facilities,"Filled geo_* from shot centroids where present, then geocoded remaining rows via Nominatim → ArcGIS.",30.0,30,0.0,0.0,16.0,16,[],[]
2025-12-04 11:57:20,3.4.4_build_facility_timezones,Appended facility_tz field from geographic coordinates; idempotent and reproducible.,30.0,30,0.0,0.0,16.0,16,[],[]
2025-12-04 11:57:20,3.4.5_enrich_facilities_from_golfcourseapi_cache_only,Queried GolfCourseAPI for facilities that needed enrichment; updated cache at facilities_api_cache.csv; API calls made: 0.,30.0,30,0.0,0.0,26.0,26,[],[]
2025-12-04 11:57:21,3.5.1_create_phase4_dataframes,"Derived golf_rounds, golf_holes (with hole_id), and golf_shots from golf_valid.",4240.0,4240,0.0,0.0,64.0,65,['hole_id'],[]
